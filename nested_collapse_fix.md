# Исправление логики коллапсирования для вложенных уровней

## Проблема
Когда родительский уровень (например, Halfyear) схлопнут, у его значений (H1, H2) не появлялись кнопки коллапсирования для раскрытия детализации внутри каждого конкретного значения.

## Решение

### 1. Новый метод `shouldShowCollapseButton`
Создан метод, который определяет, когда показывать кнопку коллапсирования:

```javascript
shouldShowCollapseButton(rowKey, allRowKeys, rowFieldValues, level) {
    // 1. Проверяем, есть ли дочерние элементы для этого уровня
    const hasChildren = this.hasChildrenForLevel(allRowKeys, level);
    if (!hasChildren) return false;
    
    // 2. Проверяем, является ли это родительской группой
    const isParentGroup = this.isParentGroup(rowKey, allRowKeys, level);
    if (isParentGroup) return true;
    
    // 3. Если родительский уровень схлопнут, показываем кнопку для текущего уровня
    if (level > 0) {
        const parentKey = this.createParentKey(rowFieldValues, level - 1);
        const isParentCollapsed = this.collapsedRows.has(parentKey);
        
        if (isParentCollapsed) {
            return true;
        }
    }
    
    return false;
}
```

### 2. Логика работы
- **Кнопка показывается** если:
  1. Есть дочерние элементы для этого уровня И
  2. Это родительская группа ИЛИ родительский уровень схлопнут

### 3. Пример поведения
- **Год 2024** схлопнут → у значений H1, H2 появляются кнопки для раскрытия кварталов
- **Полугодие H1** схлопнуто → у значений Q1, Q2, Q3 появляются кнопки для раскрытия месяцев
- **Квартал Q1** схлопнут → у значений месяцев появляются кнопки для детализации

## Результат
Теперь пользователь может:
- ✅ Схлопнуть уровень Halfyear
- ✅ Увидеть кнопки коллапсирования у H1, H2
- ✅ Раскрыть только H1 для просмотра его кварталов
- ✅ Раскрыть только Q1 внутри H1 для просмотра месяцев
- ✅ Работать с иерархией интуитивно на любом уровне

Приложение запущено на http://localhost:5001 для тестирования.
