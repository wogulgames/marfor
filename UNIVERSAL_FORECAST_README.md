# Универсальная программа прогнозирования временных рядов

## Описание

Универсальная программа для прогнозирования любых временных рядов с использованием множественной регрессии, валидации модели и автоматического определения параметров.

## Особенности

- **Автоматическое определение колонок**: программа сама находит временные колонки и колонки для прогнозирования
- **Валидация модели**: проверка качества модели на обучающей и тестовой выборках
- **Множественные алгоритмы**: Linear Regression, Ridge, Lasso, Random Forest
- **Сезонные тренды**: учет сезонности, кварталов, праздничных периодов
- **Взаимодействие признаков**: логарифмические и полиномиальные признаки
- **Визуализация**: автоматическое создание графиков прогноза

## Установка зависимостей

```bash
pip install pandas numpy scikit-learn matplotlib seaborn
```

## Использование

### 1. Простой интерфейс (рекомендуется)

```bash
python forecast_interface.py
```

Программа запросит:
- Путь к CSV файлу
- Количество периодов для прогноза
- Название выходного файла

### 2. Программный интерфейс

```python
from universal_forecast_program import UniversalForecaster

# Инициализация
forecaster = UniversalForecaster('your_data.csv')

# Загрузка данных
forecaster.load_data()

# Автоматическое определение колонок
forecaster.auto_detect_columns()

# Обучение моделей с валидацией
forecaster.train_models_with_validation()

# Создание прогноза
forecaster.create_forecast(forecast_periods=4)

# Сохранение результатов
forecaster.save_forecast('forecast_results.csv')

# Генерация отчета
forecaster.generate_model_report()

# Визуализация
forecaster.plot_forecast()
```

## Требования к данным

### Формат CSV файла

Программа автоматически определяет:
- **Временные колонки**: содержащие слова `year`, `month`, `date`, `time`, `period`, `quarter`
- **Колонки для прогнозирования**: числовые колонки (исключая ID и временные)

### Пример структуры данных

```csv
year,month,revenue,traffic,costs
2023,1,100000,5000,20000
2023,2,120000,5500,22000
2023,3,110000,5200,21000
...
```

## Алгоритм работы

### 1. Подготовка данных
- Загрузка и очистка данных
- Создание временных признаков (сезонность, кварталы, праздники)
- Автоматическое определение колонок для прогнозирования

### 2. Создание признаков
- Базовые временные признаки
- Сезонные признаки (sin/cos)
- Квартальные dummy переменные
- Полиномиальные признаки времени
- Логарифмические признаки
- Признаки взаимодействия

### 3. Обучение моделей
- Разделение на обучающую и тестовую выборки
- Обучение нескольких алгоритмов:
  - Linear Regression
  - Ridge Regression
  - Lasso Regression
  - Random Forest
- Выбор лучшей модели по R²

### 4. Валидация
- Cross-validation с временными рядами
- Проверка на переобучение
- Оценка качества прогноза

### 5. Прогнозирование
- Создание прогноза на заданное количество периодов
- Применение лучших моделей
- Корректировка отрицательных значений

## Выходные файлы

### 1. CSV файл с прогнозом
Содержит прогнозируемые значения для всех метрик на заданные периоды.

### 2. График прогноза (PNG)
Визуализация исторических данных и прогноза для основных метрик.

### 3. Отчет в консоли
- Качество моделей (R², MAE)
- Результаты валидации
- Статистика по обучающим данным

## Примеры использования

### Маркетинговые данные
```python
forecaster = UniversalForecaster('marketing_data.csv')
# Автоматически найдет колонки: revenue, traffic, ads_cost, etc.
```

### Финансовые данные
```python
forecaster = UniversalForecaster('financial_data.csv')
# Автоматически найдет колонки: sales, profit, expenses, etc.
```

### Продажи
```python
forecaster = UniversalForecaster('sales_data.csv')
# Автоматически найдет колонки: units_sold, revenue, etc.
```

## Настройка параметров

### Временные колонки
```python
forecaster = UniversalForecaster(
    csv_file='data.csv',
    date_columns=['year', 'month', 'quarter']
)
```

### Целевые колонки
```python
forecaster = UniversalForecaster(
    csv_file='data.csv',
    target_columns=['revenue', 'traffic', 'costs']
)
```

### Параметры валидации
```python
forecaster.train_models_with_validation(
    test_size=0.2,      # 20% данных для тестирования
    cv_folds=5          # 5 фолдов для cross-validation
)
```

## Интерпретация результатов

### R² (коэффициент детерминации)
- **> 0.8**: отличное качество модели
- **0.6-0.8**: хорошее качество
- **0.4-0.6**: удовлетворительное качество
- **< 0.4**: низкое качество

### MAE (средняя абсолютная ошибка)
Показывает среднее отклонение прогноза от фактических значений.

### Cross-validation
Показывает стабильность модели на разных частях данных.

## Устранение проблем

### Низкое качество модели
1. Проверьте достаточность данных (минимум 20 записей)
2. Убедитесь в наличии трендов в данных
3. Проверьте корректность временных колонок

### Ошибки при загрузке
1. Проверьте формат CSV файла
2. Убедитесь в наличии числовых колонок
3. Проверьте кодировку файла (должна быть UTF-8)

### Проблемы с памятью
1. Уменьшите количество признаков
2. Используйте меньший размер тестовой выборки
3. Обработайте данные по частям

## Расширение функциональности

Программа легко расширяется для добавления:
- Новых алгоритмов машинного обучения
- Дополнительных признаков
- Специфичных метрик качества
- Экспорта в другие форматы

## Лицензия

Программа предоставляется "как есть" для образовательных и коммерческих целей.
